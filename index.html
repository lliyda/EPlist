<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no,viewport-fit=cover" />
  <title>AK/EP çœŸå®è¿˜åŸç‰ˆ (v3.0)</title>
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vant@2.12/lib/index.css" />

  <style>
    /* === å…¨å±€åŸºç¡€ === */
    body { background-color: #f5f5f5; font-family: -apple-system, BlinkMacSystemFont, Roboto, sans-serif; margin: 0; padding: 0; }
    [v-cloak] { display: none; }

    /* =========================================
       1. åˆ—è¡¨é¡µæ ·å¼ (ä¿æŒä¸å˜ï¼Œæ¨¡æ‹Ÿ ep.list.css)
       ========================================= */
    .EpList { padding-top: 10px; padding-bottom: 60px; }
    .items { display: flex; flex-direction: column; gap: 15px; padding: 15px; min-height: 300px; }
    
    /* è„šæœ¬ç›®æ ‡ï¼šåˆ—è¡¨å¡ç‰‡ */
    .items .item {
      background: #fff; border-radius: 10px; padding: 15px;
      position: relative; box-shadow: 0 2px 8px rgba(0,0,0,0.05); cursor: pointer;
    }
    .item .top { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; border-bottom: 1px dashed #eee; padding-bottom: 10px; }
    .item .avatar { width: 40px; height: 40px; border-radius: 50%; background: #eee; }
    .item .name { font-weight: bold; font-size: 16px; color: #333; }
    .item .center { display: flex; justify-content: space-around; margin-bottom: 10px; }
    .center-item { text-align: center; }
    .center-item .value { font-size: 20px; font-weight: bold; color: #000; }
    .center-item .label { font-size: 12px; color: #666; }
    .item .bottom { 
      background: linear-gradient(90deg, #00C0F2 0%, #BFFC85 100%);
      color: #fff; padding: 5px 15px; border-radius: 20px; 
      display: flex; justify-content: space-between; font-size: 12px;
    }
    .empty-tip { text-align: center; color: #999; padding-top: 80px; font-size: 14px; }

    /* =========================================
       2. è¯¦æƒ…é¡µæ ·å¼ (ä¸¥æ ¼å¯¹åº” ep.list.detail.css)
       ========================================= */
    #detail-page {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: #f5f5f5; z-index: 999; display: flex; flex-direction: column;
      overflow-y: auto;
    }

    /* å®¹å™¨ */
    .EpListDetail {
      padding: 20px;
      display: flex; flex-direction: column;
    }
    .content-container { margin-top: 10px; }

    /* --- ä¸Šéƒ¨å¡ç‰‡: Basic Info --- */
    .basic-info {
        background-color: #FFFDFD;
        border: 1px solid #ddd;
        border-radius: 20px;
        padding-bottom: 20px;
    }
    /* é¡¶éƒ¨å–å®¶ä¿¡æ¯ */
    .basic-info .top {
        display: flex; align-items: center; column-gap: 15px;
        margin: 12px 20px 0; padding: 0 6px 13.5px;
        border-bottom: 1px dashed #FFD0A8;
    }
    .basic-info .top .avatar {
        width: 45px; height: 45px; border-radius: 50%; border: 2px solid #cdcdcd; background: #eee;
    }
    .basic-info .top .seller-name {
        font-weight: bold; font-size: 16px; color: #333;
    }

    /* ä¸­é—´é‡‘é¢å¤§å­— */
    .basic-info .center {
        text-align: center; padding: 30px 0;
    }
    .basic-info .center .amount {
        font-size: 34px; font-weight: bold; color: #00C0F2; line-height: 1;
    }
    .basic-info .center .label {
        font-size: 12px; color: #999; margin-top: 8px;
    }

    /* åº•éƒ¨æ¸å˜æ¡ */
    .basic-info .bottom {
        margin: 0 20px;
        background-image: linear-gradient(90deg, #00C0F2 0%, #BFFC85 100%);
        border-radius: 20px;
        height: 30px; /* æ¨¡æ‹Ÿè£…é¥°æ¡é«˜åº¦ */
        display: flex; align-items: center; padding: 0 15px;
    }
    
    /* --- ä¸‹éƒ¨åˆ—è¡¨: Time Items --- */
    .time-items {
        display: flex; flex-direction: column; row-gap: 16px;
        border: 1px solid #ddd; background-color: #fff;
        border-radius: 20px; margin-top: 20px; padding: 30px 24px;
    }
    .time-item {
        display: flex; justify-content: space-between; align-items: center;
        font-size: 14px;
    }
    .time-item .left { color: #666; }
    .time-item .right { color: #000; font-weight: bold; }
    
    /* åˆ†å‰²çº¿ */
    .time-item:not(:last-of-type) {
        padding-bottom: 16px; border-bottom: 1px solid #f5f5f5;
    }

    /* --- æŒ‰é’®ç»„ä»¶ (æ¨¡æ‹Ÿ CustomButton) --- */
    .button-container { margin-top: 40px; padding: 0 10px; }
    
    .CustomButton {
        cursor: pointer; user-select: none;
    }
    .CustomButton .custom-content {
        height: 45px;
        border-radius: 999px;
        background-image: linear-gradient(90deg, #00C0F2 0%, #BFFC85 100%);
        color: #fff; font-size: 16px; font-weight: bold;
        display: flex; align-items: center; justify-content: center;
        box-shadow: 0 4px 10px rgba(0, 192, 242, 0.3);
    }
    .CustomButton:active .custom-content { opacity: 0.9; transform: scale(0.98); }

    /* =========================================
       3. æˆåŠŸé¡µæ ·å¼
       ========================================= */
    #success-page {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: #fff; z-index: 1001;
      display: flex; flex-direction: column;
    }
    .success-content { padding: 60px 30px; text-align: center; }
    .success-title { font-size: 22px; font-weight: bold; margin: 20px 0 10px; color: #333; }
    .success-desc { font-size: 14px; color: #999; margin-bottom: 50px; line-height: 1.6; }
    
    /* è„šæœ¬ç‰¹æ•ˆæ¨¡æ‹Ÿ */
    .ak-target-hit { border: 2px solid red !important; animation: ak-shake 0.4s; }
    @keyframes ak-shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-5px)} 75%{transform:translateX(5px)} }
  </style>
</head>

<body>
  <div id="app" v-cloak>
    
    <div class="EpList" v-show="!showDetail && !showSuccess">
      <van-tabs v-model="tabActive" @click="onTabClick" sticky>
        <van-tab v-for="(item, index) in tabControl" :key="index" :title="item.title">
          <van-pull-refresh v-model="item.isReloading" @refresh="onRefresh">
            <van-list v-model="item.loading" :finished="item.finished" finished-text="æ²¡æœ‰æ›´å¤šäº†" @load="loadMore">
              <div style="background:#fff3e0; color:#e65100; padding:8px; font-size:12px; text-align:center;">
                æ¨¡æ‹Ÿç¯å¢ƒï¼šç¬¬ <b>{{ refreshCount }}</b> æ¬¡åˆ·æ–° 
                <span v-if="refreshCount < 4">(æš‚æ— )</span>
                <span v-else style="color:green; font-weight:bold;">(ğŸ”¥ å‡ºç°è®¢å•!)</span>
              </div>

              <div class="items">
                <div v-if="item.list.length === 0" class="empty-tip">
                  <van-loading size="24px" vertical>åŠ è½½ä¸­...</van-loading>
                  <div style="margin-top:10px">æš‚æ— æŒ‚å•æ•°æ®</div>
                </div>
                <div class="item" v-for="(_item, _index) of item.list" :key="_index" @click="gotoDetail(_item)">
                  <div class="top">
                    <div class="avatar"></div>
                    <div class="name">{{ _item.Seller.FlowNumber }}</div>
                  </div>
                  <div class="center">
                    <div class="center-item"><div class="value">{{ _item.EPAmount }}</div><div class="label">EP</div></div>
                    <div class="center-item"><div class="value">{{ _item.Netincome }}</div><div class="label">USDT</div></div>
                  </div>
                  <div class="bottom">
                    <div class="left">{{ _item.Nation }}</div>
                    <div class="right">{{ _item.CreateTime }}</div>
                  </div>
                </div>
              </div>
            </van-list>
          </van-pull-refresh>
        </van-tab>
      </van-tabs>
    </div>

    <div id="detail-page" v-if="showDetail">
      <van-nav-bar title="å‡ºå”®è©³æƒ…" left-arrow @click-left="closeDetail"></van-nav-bar>
      
      <div class="EpListDetail">
        <div class="content-container">
            
            <div class="basic-info">
                <div class="top">
                    <div class="avatar"></div>
                    <div class="seller-name">{{ currentItem.Seller.FlowNumber }}</div>
                </div>
                <div class="center">
                    <div class="amount">{{ currentItem.EPAmount }}</div>
                    <div class="label">EPæ•°é‡</div>
                </div>
                <div class="bottom">
                    </div>
            </div>

            <div class="time-items">
                <div class="time-item">
                    <div class="left">å®ä»˜é‡‘é¢</div>
                    <div class="right">{{ currentItem.Netincome }} USDT</div>
                </div>
                <div class="time-item">
                    <div class="left">äº¤æ˜“å•å·</div>
                    <div class="right">EP{{ currentItem.Id }}</div>
                </div>
                <div class="time-item">
                    <div class="left">åˆ›å»ºæ—¶é—´</div>
                    <div class="right">{{ currentItem.CreateTime }}</div>
                </div>
            </div>

            <div class="button-container">
                <div class="CustomButton" @click="onBuyClick" role="button">
                    <div class="custom-content">
                        ç¢ºèªè³¼è²·
                    </div>
                </div>
            </div>

        </div>
      </div>
    </div>

    <div id="success-page" v-if="showSuccess">
      <van-nav-bar title="æ“ä½œçµæœ" left-arrow @click-left="goBackToList"></van-nav-bar>
      <div class="success-content">
        <van-icon name="checked" color="#07c160" size="80" style="margin-bottom:20px"></van-icon>
        <div class="success-title">æ¶å–®æˆåŠŸï¼Œè«‹ç›¡å¿«ä»˜æ¬¾</div>
        <div class="success-desc">
            ç‚ºäº†é¿å…æ‚¨çš„äº¤æ˜“ä¿¡ç”¨é™ä½ï¼Œè«‹æ‚¨åŠæ™‚è½‰è³¬çµ¦è³£å®¶ä¸¦åœ¨â€œè²·è³£ä¸­å¿ƒâ€ä¸­é»æ“Šâ€œç¢ºèªä»˜æ¬¾â€æŒ‰éˆ•
        </div>
        <div style="display:flex; flex-direction:column; gap:15px;">
            <van-button size="large" type="primary" color="#07c160">è¿”å›ç©å®¶è´¦æˆ·</van-button>
            <van-button size="large" plain @click="goBackToList">è¿”å›å‡ºå”®åˆ—è¡¨</van-button>
        </div>
      </div>
    </div>

  </div>

  <script src="https://cdn.jsdelivr.net/npm/vue@2.6/dist/vue.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vant@2.12/lib/vant.min.js"></script>

  <script>
    window.APP = {
      GLOBAL: { getUserModel: () => ({ FlowNumber: 'MyUser123' }), toastMsg: (msg) => vant.Toast(msg) },
      CONFIG: { BASE_Shunt: 'https://mock-api.com/' }
    };

    window._vue = new Vue({
      el: '#app',
      data: {
        tabActive: 0, showDetail: false, showSuccess: false, currentItem: {}, refreshCount: 0, 
        tabControl: [
          { title: 'æŒ‚å–®ä¸­', list: [], pageIndex: 0, isLoading: false, loading: false, finished: false, isReloading: false },
          { title: 'äº¤æ˜“ä¸­', list: [] }, { title: 'å·²å®Œæˆ', list: [] }
        ]
      },
      methods: {
        loadPageData() {
          const tab = this.tabControl[this.tabActive];
          tab.isLoading = true; 
          this.refreshCount++;
          console.log(`[Mock] åˆ·æ–°è¯·æ±‚... (ç¬¬ ${this.refreshCount} æ¬¡)`);
          
          setTimeout(() => {
            if (this.tabActive === 0 && this.refreshCount >= 4) {
              tab.list = [{
                Id: 888888, EPAmount: 1000, Netincome: 920, Currency: 'USDT', Nation: 'Global',
                StatusName: 'å‡ºå”®ä¸­', CreateTime: 'åˆšåˆš', Seller: { FlowNumber: 'RichMan001' }
              }];
              console.log('[Mock] âœ… è®¢å•å·²åˆ·æ–°å‡ºæ¥ï¼');
            } else {
              tab.list = [];
              console.log('[Mock] â³ æ— è®¢å•ï¼Œç»§ç»­ç­‰å¾…...');
            }
            tab.loading = false; tab.isLoading = false; tab.isReloading = false;
          }, 300); 
        },
        onRefresh() { this.tabControl[this.tabActive].finished = false; this.loadPageData(); },
        loadMore() { setTimeout(() => { this.tabControl[this.tabActive].loading = false; }, 500); },
        onTabClick() { this.loadPageData(); },
        
        gotoDetail(item) {
          console.log('[Mock] è¿›å…¥è¯¦æƒ…é¡µ');
          this.currentItem = item;
          this.showDetail = true;
        },
        closeDetail() { this.showDetail = false; },

        onBuyClick() {
          console.log('[Mock] ç‚¹å‡»äº†è‡ªå®šä¹‰è´­ä¹°æŒ‰é’®');
          this.$dialog.confirm({
            title: 'è³¼è²·EPäº¤æ˜“ç¢ºèª', message: 'ç¡®è®¤è¦è´­ä¹°æ­¤è®¢å•å—ï¼Ÿ', confirmButtonText: 'ç¢ºèª', cancelButtonText: 'å–æ¶ˆ'
          })
          .then(() => {
            this.$toast.loading({ duration: 0, forbidClick: true, message: 'æŠ¢å•ä¸­...' });
            setTimeout(() => {
              this.$toast.clear();
              this.showDetail = false;
              this.showSuccess = true;
              console.log('[Mock] æŠ¢å•æˆåŠŸï¼Œè·³è½¬ç»“æœé¡µ');
            }, 600);
          }).catch(() => {});
        },

        goBackToList() {
          console.log('[Mock] è¿”å›åˆ—è¡¨ï¼Œé‡ç½®æµç¨‹');
          this.showSuccess = false;
          this.showDetail = false;
          this.refreshCount = 0; 
          this.tabControl[0].list = [];
          this.loadPageData();
        }
      },
      mounted() { this.loadPageData(); }
    });
  </script>
</body>
</html>
