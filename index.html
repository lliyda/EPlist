<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no,viewport-fit=cover" />
  <title>AK/EP çœŸå®å…¨æµç¨‹æ¨¡æ‹Ÿ (v2.0)</title>
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vant@2.12/lib/index.css" />

  <style>
    /* === å…¨å±€åŸºç¡€æ ·å¼ === */
    body { background-color: #f5f5f5; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; margin: 0; padding: 0; }
    [v-cloak] { display: none; }

    /* =========================================
       1. åˆ—è¡¨é¡µæ ·å¼ (æ¨¡æ‹Ÿ ep.list.css)
       ========================================= */
    .EpList { padding-top: 10px; padding-bottom: 60px; }
    .items { display: flex; flex-direction: column; gap: 15px; padding: 15px; min-height: 300px; }
    
    /* æ ¸å¿ƒç›®æ ‡ï¼šè„šæœ¬åœ¨åˆ—è¡¨é¡µå¯»æ‰¾çš„å…ƒç´  */
    .items .item {
      background: #fff; border-radius: 10px; padding: 15px;
      position: relative; box-shadow: 0 2px 8px rgba(0,0,0,0.05); cursor: pointer;
    }

    .item .top { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; border-bottom: 1px dashed #eee; padding-bottom: 10px; }
    .item .avatar { width: 40px; height: 40px; border-radius: 50%; background: #eee; }
    .item .name { font-weight: bold; font-size: 16px; color: #333; }
    
    .item .center { display: flex; justify-content: space-around; margin-bottom: 10px; }
    .center-item { text-align: center; }
    .center-item .value { font-size: 20px; font-weight: bold; color: #000; }
    .center-item .label { font-size: 12px; color: #666; }

    .item .bottom { 
      background: linear-gradient(90deg, #00C0F2 0%, #BFFC85 100%);
      color: #fff; padding: 5px 15px; border-radius: 20px; 
      display: flex; justify-content: space-between; font-size: 12px;
    }

    .empty-tip { text-align: center; color: #999; padding-top: 80px; font-size: 14px; }

    /* =========================================
       2. è¯¦æƒ…é¡µæ ·å¼ (è¿˜åŸ ep.list.detail.html)
       ========================================= */
    #detail-page {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: #f5f5f5; z-index: 999; display: flex; flex-direction: column;
      overflow-y: auto;
    }

    .detail-container { padding: 15px; }

    /* è¯¦æƒ…å¡ç‰‡ç»“æ„ */
    .detail-card {
        background: #fff; border-radius: 10px; padding: 20px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        margin-bottom: 30px;
    }
    .detail-row { display: flex; justify-content: space-between; margin-bottom: 15px; font-size: 14px; color: #666; }
    .detail-row .val { color: #000; font-weight: bold; }
    .detail-amount { text-align: center; font-size: 32px; font-weight: bold; color: #00C0F2; margin: 20px 0; }
    .detail-seller { display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 20px; border-bottom: 1px solid #f0f0f0; padding-bottom: 15px;}

    /* === é‡ç‚¹ï¼šè¿˜åŸ CustomButton ç»„ä»¶ç»“æ„ === 
       è¿™æ˜¯è„šæœ¬åœ¨è¯¦æƒ…é¡µéœ€è¦ç‚¹å‡»çš„ç›®æ ‡ */
    .CustomButton {
        margin: 20px 25px;
        cursor: pointer;
        user-select: none;
    }
    .CustomButton .custom-content {
        height: 45px;
        border-radius: 999px;
        background-image: linear-gradient(90deg, #00C0F2 0%, #BFFC85 100%);
        color: #fff;
        font-size: 16px;
        font-weight: bold;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 10px rgba(0, 192, 242, 0.3);
    }
    .CustomButton:active .custom-content { opacity: 0.9; transform: scale(0.98); }

    /* =========================================
       3. æˆåŠŸé¡µæ ·å¼
       ========================================= */
    #success-page {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: #fff; z-index: 1001;
      display: flex; flex-direction: column;
    }
    .success-content { padding: 60px 30px; text-align: center; }
    .success-title { font-size: 22px; font-weight: bold; margin: 20px 0 10px; color: #333; }
    .success-desc { font-size: 14px; color: #999; margin-bottom: 50px; line-height: 1.6; }
    
    /* è„šæœ¬ç‚¹å‡»æ—¶çš„ç‰¹æ•ˆæ ·å¼ (è„šæœ¬æ³¨å…¥ï¼Œè¿™é‡Œæ¨¡æ‹Ÿä¸€ä¸‹æ•ˆæœ) */
    .ak-target-hit { border: 2px solid red !important; animation: ak-shake 0.4s; }
    @keyframes ak-shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-5px)} 75%{transform:translateX(5px)} }
  </style>
</head>

<body>
  <div id="app" v-cloak>
    
    <div class="EpList" v-show="!showDetail && !showSuccess">
      <van-tabs v-model="tabActive" @click="onTabClick" sticky>
        <van-tab v-for="(item, index) in tabControl" :key="index" :title="item.title">
          
          <van-pull-refresh v-model="item.isReloading" @refresh="onRefresh">
            <van-list v-model="item.loading" :finished="item.finished" finished-text="æ²¡æœ‰æ›´å¤šäº†" @load="loadMore">
              
              <div style="background:#fff3e0; color:#e65100; padding:8px; font-size:12px; text-align:center;">
                æ¨¡æ‹Ÿç¯å¢ƒï¼šç¬¬ <b>{{ refreshCount }}</b> æ¬¡åˆ·æ–° 
                <span v-if="refreshCount < 4">(æš‚æ— è®¢å•)</span>
                <span v-else style="color:green; font-weight:bold;">(ğŸ”¥ è®¢å•å‡ºç°!)</span>
              </div>

              <div class="items">
                <div v-if="item.list.length === 0" class="empty-tip">
                  <van-loading size="24px" vertical>åŠ è½½ä¸­...</van-loading>
                  <div style="margin-top:10px">æš‚æ— æŒ‚å•æ•°æ®</div>
                </div>

                <div class="item" v-for="(_item, _index) of item.list" :key="_index" @click="gotoDetail(_item)">
                  <div class="top">
                    <div class="avatar"></div>
                    <div class="name">{{ _item.Seller.FlowNumber }}</div>
                  </div>
                  <div class="center">
                    <div class="center-item"><div class="value">{{ _item.EPAmount }}</div><div class="label">EP</div></div>
                    <div class="center-item"><div class="value">{{ _item.Netincome }}</div><div class="label">USDT</div></div>
                  </div>
                  <div class="bottom">
                    <div class="left">{{ _item.Nation }}</div>
                    <div class="right">{{ _item.CreateTime }}</div>
                  </div>
                </div>
              </div>

            </van-list>
          </van-pull-refresh>
        </van-tab>
      </van-tabs>
    </div>

    <div id="detail-page" v-if="showDetail">
      <van-nav-bar title="å‡ºå”®è©³æƒ…" left-arrow @click-left="closeDetail"></van-nav-bar>
      
      <div class="detail-container">
        <div class="detail-card">
            <div class="detail-seller">
                <div style="width:30px;height:30px;background:#eee;border-radius:50%"></div>
                <span>{{ currentItem.Seller.FlowNumber }}</span>
            </div>
            
            <div class="detail-amount">{{ currentItem.EPAmount }} EP</div>
            
            <div class="detail-row"><span>å®ä»˜é‡‘é¢</span><span class="val">{{ currentItem.Netincome }} USDT</span></div>
            <div class="detail-row"><span>äº¤æ˜“å•å·</span><span class="val">EP{{ currentItem.Id }}</span></div>
            <div class="detail-row"><span>çŠ¶æ€</span><span class="val" style="color:#00C0F2">{{ currentItem.StatusName }}</span></div>
            <div class="detail-row"><span>åˆ›å»ºæ—¶é—´</span><span class="val">{{ currentItem.CreateTime }}</span></div>
        </div>

        <div class="CustomButton" @click="onBuyClick" role="button">
            <div class="custom-content">
                ç¢ºèªè³¼è²·
            </div>
        </div>
      </div>
    </div>

    <div id="success-page" v-if="showSuccess">
      <van-nav-bar title="æ“ä½œçµæœ" left-arrow @click-left="goBackToList"></van-nav-bar>
      
      <div class="success-content">
        <van-icon name="checked" color="#07c160" size="80" style="margin-bottom:20px"></van-icon>
        <div class="success-title">æ¶å–®æˆåŠŸï¼Œè«‹ç›¡å¿«ä»˜æ¬¾</div>
        <div class="success-desc">
            ç‚ºäº†é¿å…æ‚¨çš„äº¤æ˜“ä¿¡ç”¨é™ä½ï¼Œè«‹æ‚¨åŠæ™‚è½‰è³¬çµ¦è³£å®¶ä¸¦åœ¨â€œè²·è³£ä¸­å¿ƒâ€ä¸­é»æ“Šâ€œç¢ºèªä»˜æ¬¾â€æŒ‰éˆ•
        </div>
        
        <div style="display:flex; flex-direction:column; gap:15px;">
            <van-button size="large" type="primary" color="#07c160">è¿”å›ç©å®¶è´¦æˆ·</van-button>
            
            <van-button size="large" plain @click="goBackToList">è¿”å›å‡ºå”®åˆ—è¡¨</van-button>
        </div>
      </div>
    </div>

  </div>

  <script src="https://cdn.jsdelivr.net/npm/vue@2.6/dist/vue.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vant@2.12/lib/vant.min.js"></script>

  <script>
    // æ¨¡æ‹Ÿå…¨å±€ç¯å¢ƒ
    window.APP = {
      GLOBAL: { getUserModel: () => ({ FlowNumber: 'MyUser123' }), toastMsg: (msg) => vant.Toast(msg) },
      CONFIG: { BASE_Shunt: 'https://mock-api.com/' }
    };

    window._vue = new Vue({
      el: '#app',
      data: {
        tabActive: 0,
        showDetail: false,
        showSuccess: false,
        currentItem: {},
        refreshCount: 0, 
        language: { INPUT_PLAYER_ID: 'è¯·è¾“å…¥ID', SEARCH: 'æœç´¢' },
        tabControl: [
          { title: 'æŒ‚å–®ä¸­', list: [], pageIndex: 0, isLoading: false, loading: false, finished: false, isReloading: false },
          { title: 'äº¤æ˜“ä¸­', list: [] },
          { title: 'å·²å®Œæˆ', list: [] }
        ]
      },
      methods: {
        // === æ ¸å¿ƒæ•°æ®åŠ è½½é€»è¾‘ ===
        loadPageData() {
          const tab = this.tabControl[this.tabActive];
          tab.isLoading = true; // è„šæœ¬åˆ©ç”¨æ­¤çŠ¶æ€åˆ¤æ–­åˆ·æ–°æ˜¯å¦å¼€å§‹
          
          this.refreshCount++;
          console.log(`[Mock] åˆ·æ–°è¯·æ±‚... (ç¬¬ ${this.refreshCount} æ¬¡)`);
          
          // æ¨¡æ‹Ÿ 300ms ç½‘ç»œå»¶è¿Ÿ
          setTimeout(() => {
            // ç¬¬ 4 æ¬¡åˆ·æ–°æ—¶ï¼Œæ”¾å‡ºè®¢å•
            if (this.tabActive === 0 && this.refreshCount >= 4) {
              tab.list = [{
                Id: 888888, EPAmount: 1000, Netincome: 920, Currency: 'USDT', Nation: 'Global',
                StatusName: 'å‡ºå”®ä¸­', CreateTime: 'åˆšåˆš', Seller: { FlowNumber: 'RichMan001' }
              }];
              console.log('[Mock] âœ… è®¢å•å·²åˆ·æ–°å‡ºæ¥ï¼');
            } else {
              tab.list = [];
              console.log('[Mock] â³ æ— è®¢å•ï¼Œç»§ç»­ç­‰å¾…...');
            }
            
            // è„šæœ¬åˆ©ç”¨æ­¤çŠ¶æ€å˜ false åˆ¤æ–­åˆ·æ–°ç»“æŸ
            tab.loading = false;
            tab.isLoading = false; 
            tab.isReloading = false;
          }, 300); 
        },

        onRefresh() { this.tabControl[this.tabActive].finished = false; this.loadPageData(); },
        loadMore() { setTimeout(() => { this.tabControl[this.tabActive].loading = false; }, 500); },
        onTabClick() { this.loadPageData(); },
        
        gotoDetail(item) {
          console.log('[Mock] è¿›å…¥è¯¦æƒ…é¡µ');
          this.currentItem = item;
          this.showDetail = true;
        },
        closeDetail() { this.showDetail = false; },

        onBuyClick() {
          console.log('[Mock] ç‚¹å‡»äº†è‡ªå®šä¹‰è´­ä¹°æŒ‰é’®');
          // å¼¹å‡º Vant Dialogï¼Œè¿™æ˜¯è„šæœ¬ç¬¬äºŒæ­¥è¦æ‹¦æˆªçš„
          this.$dialog.confirm({
            title: 'è³¼è²·EPäº¤æ˜“ç¢ºèª',
            message: 'ç¡®è®¤è¦è´­ä¹°æ­¤è®¢å•å—ï¼Ÿ',
            confirmButtonText: 'ç¢ºèª', // ç¹ä½“åŒ¹é…
            cancelButtonText: 'å–æ¶ˆ'
          })
          .then(() => {
            this.$toast.loading({ duration: 0, forbidClick: true, message: 'æŠ¢å•ä¸­...' });
            setTimeout(() => {
              this.$toast.clear();
              this.showDetail = false;
              this.showSuccess = true;
              console.log('[Mock] æŠ¢å•æˆåŠŸï¼Œè·³è½¬ç»“æœé¡µ');
            }, 600);
          })
          .catch(() => {});
        },

        goBackToList() {
          console.log('[Mock] è¿”å›åˆ—è¡¨ï¼Œé‡ç½®æµç¨‹');
          this.showSuccess = false;
          this.showDetail = false;
          this.refreshCount = 0; // é‡ç½®è®¡æ•°å™¨ï¼Œæ–¹ä¾¿å¾ªç¯æµ‹è¯•
          this.tabControl[0].list = [];
          this.loadPageData();
        }
      },
      mounted() {
        this.loadPageData();
      }
    });
  </script>
</body>
</html>
